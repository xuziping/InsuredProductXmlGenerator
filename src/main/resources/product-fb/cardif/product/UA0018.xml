<?xml version="1.0" encoding="UTF-8" ?>
<declare>
    <product
            id="UA0018"
            corporation_id="cardif"
            code="UA0018"
            name="法商法國巴黎人壽金賺100變額年金保險"
            name_abbr="金賺100變額年金"
            unit="1"
            type_code="annuity"
            sequence="1000"
            sale_begin_date="2017-01-01"
            sale_end_date=""
            quantity="1"
            input="premium"
            amount="0"
            last_modify_date="2017-01-01">

        <param>
            <pay_freq>
                <item code="single" />
            </pay_freq>

            <pay>
                <item code="term_1" />
            </pay>

            <insure>
                <item code="to_full" />
            </insure>

        </param>

        <proposal_input>
            <item name="PAY_FREQ" label ="繳別" widget="select">buildOption('pay_freq')</item>
            <item name="PREMIUM" label="保費" widget="input"></item>
            <item name="PAY_ANNUITY_AGE" label="年金給付開始之保單年度" widget="hidden">80</item>
            <item name="PAY" label="預計繳費" widget="label">PAY</item>
        </proposal_input>

        <fund_input>
            <item name="MF" label="MF" widget="input"></item>
            <item name="ETF" label="ETF" widget="input"></item>
            <item name="投資賬戶" label="投資賬戶" widget="input"></item>
            <item name="貨幣賬戶" label="貨幣賬戶" widget="input"></item>
            <item name="報酬率1" label="報酬率1" widget="input"></item>
            <item name="報酬率2" label="報酬率2" widget="input"></item>
            <item name="報酬率3" label="報酬率3" widget="input"></item>
        </fund_input>

        <apply_input>
            <item name="PAY_FREQ" label ="繳別" widget="select">buildOption('pay_freq')</item>
            <item name="PREMIUM" label="保費" widget="input"></item>
            <item name="ANNUITY_AGE" label="年金給付開始之保單年度" widget="input"></item>
        </apply_input>

        <init>
            <item name="SCALE" value="100" />
            <item name="PRECISION" value="9" />
            <item name="FEE_PRECISION" value="12" />
            <item name="FEE_PRECISION2" value="11" />
            <item name="MGT_FEE_FIXED" value="100" />
            <item name="m" value="80 - AGE"></item>
        </init>

        <risk>
        </risk>

        <interest>
            <var name="MGT_FEE_RATE" param="M1" formula="M1 le 48 ? 0.00165 * 12: 0" /> <!-- 年度賬戶管理費用率 (AM) -->
            <var name="PRM" param="M1" formula="M1==1 ? PREMIUM : 0" /> <!-- 期繳保費，此處是躉交 -->
            <var name="PRM_T" param="M1" formula="(M1>0?IT.PRM_T(M1-1):0)+IT.PRM(M1)" /> <!-- 總保費，此處是躉交 -->
            <!--<var name="PRM" param="M1" formula="M1==1 ? 100000:0" /> &lt;!&ndash; 期繳保費，此處是躉交 &ndash;&gt;-->
            <!--<var name="PRM_T" param="M1" formula="100000" />-->

            <var name="MGT_FEE_AV_TMP" param="M1,A2" formula="ceil(IT.END_AV_MONTH(M1,A2) * IT.MGT_FEE_RATE(M1),FEE_PRECISION2)" />
            <var name="MGT_FEE_AV_MONTH" param="M1,A2" formula="M1>48 ? 0: round( IT.MGT_FEE_AV_TMP(M1,A2) / 12 , FEE_PRECISION)" /> <!-- 賬戶管理費用，按月計 (AN) -->
            <var name="MGT_FEE_FIXED_MONTH" param="M1" formula="M1>0 ? MGT_FEE_FIXED :0" /> <!-- 保單維護費，按月計 (AO) -->
            <var name="MGT_FEE_T" param="M1,A2" formula="IT.MGT_FEE_AV_MONTH(M1,A2) + IT.MGT_FEE_FIXED_MONTH(M1)" /> <!-- 保單費用加總，按月計 (AT) -->
            <var name="MGT_FEE_YEAR" param="A1,A2" formula="IT.MGT_FEE_T(A1*12+1,A2)+IT.MGT_FEE_T(A1*12+2,A2)+IT.MGT_FEE_T(A1*12+3,A2)+IT.MGT_FEE_T(A1*12+4,A2)+IT.MGT_FEE_T(A1*12+5,A2)+IT.MGT_FEE_T(A1*12+6,A2)+IT.MGT_FEE_T(A1*12+7,A2)+IT.MGT_FEE_T(A1*12+8,A2)+IT.MGT_FEE_T(A1*12+9,A2)+IT.MGT_FEE_T(A1*12+10,A2)+IT.MGT_FEE_T(A1*12+11,A2)+IT.MGT_FEE_T(A1*12+12,A2)" /> <!-- 保單費用加總，按年計 -->

            <var name="END_AV_B_PARTIAL_SURRENDER" param="M1,A2" formula="M1 le 0? 0: round(IT.END_AV_MONTH(M1,A2)-IT.MGT_FEE_T(M1,A2),PRECISION) " /> <!-- 月底AV部分解約前 (AU) -->
            <var name="END_AV_A_PARTIAL_SURRENDER" param="M1,A2" formula="M1 lt 0? 0: max(0, round(IT.END_AV_B_PARTIAL_SURRENDER(M1,A2), PRECISION))" /> <!-- 月底AV部分解約后 (AZ) -->
            <var name="AV_STAM_WITH_FLEXIBLE_PREMIUM" param="M1,A2" formula="M1 le (m+1)*12 ?  round(IT.PRM(M1)+IT.END_AV_A_PARTIAL_SURRENDER(M1-1,A2)+IT.JZJFJ(M1,A2),PRECISION):0" /> <!-- 保單賬戶價值 按月初計 (AG) -->

            <var name="END_AV_MONTH" param="M1,A2" formula="(M1 le (m+1)*12) and M1 ge 0 ? round(IT.AV_STAM_WITH_FLEXIBLE_PREMIUM(M1,A2) * 1.00486755056534,PRECISION) :0"></var> <!-- 月底AV  按月末計 (AI)-->
            <var name="END_AV_YEAR" param="A1,A2" formula="IT.END_AV_B_PARTIAL_SURRENDER(A1*12,A2)"></var> <!-- 保單賬戶價值 按第12月的月底AV部分解約前計-->
            <var name="JZJFJ" param="M1,A2" formula="M1 le 12 or (M1 gt (m+1)*12) ? 0 : IT.JZJF_AUM_RATE(M1)*IT.LAST_YEAR_JZJFJ_AV_AUM(M1,A2)" /> <!-- 加值給付金+超值回饋金 (BL) -->
            <var name="JZJF_AUM_RATE" param="M1" formula="M1%12==1 ? 0.001 : 0" /> <!-- 加值給付AUM%  （BJ） -->
            <var name="LAST_YEAR_JZJFJ_AV_AUM" param="M1,A2" formula="M1 le 12 ? 0 : (IT.END_AV_MONTH(M1-1,A2) + IT.END_AV_MONTH(M1-2,A2) + IT.END_AV_MONTH(M1-3,A2) + IT.END_AV_MONTH(M1-4,A2) + IT.END_AV_MONTH(M1-5,A2) + IT.END_AV_MONTH(M1-6,A2) + IT.END_AV_MONTH(M1-7,A2) + IT.END_AV_MONTH(M1-8,A2) + IT.END_AV_MONTH(M1-9,A2) + IT.END_AV_MONTH(M1-10,A2) + IT.END_AV_MONTH(M1-11,A2) + IT.END_AV_MONTH(M1-12,A2))/12" /> <!-- 前一年加值金給付基礎AUM平均：前十二月的保單價值平均值 （BN）-->
        </interest>

        <attachment>
            <benefit_table filter="table" parser="table">
                <table desc="調試使用：按月統計">
                    <row type="title">
                        <blank row="1">'保單月'</blank>
                        <blank row="1">'累積所繳保險費'</blank>
                        <blank row="1">'相關費用（保費費用、保單管理費）'</blank>
                        <blank row="1">'加值給付金'</blank>
                        <blank row="1">'月初AV'</blank>
                        <blank row="1">'月底AV'</blank>
                        <blank row="1">'中间值'</blank>
                        <blank row="1">'保單賬戶價值'</blank>
                    </row>
                    <loop from="0" to="100" step="1" name="I">
                        <row>
                            <blank style="##0">I</blank>
                            <blank align="right" style="########0.0000000000000">IT.MGT_FEE_AV_TMP(I,0.06)</blank>
                            <blank align="right" style="########0.0000000000000">IT.MGT_FEE_T(I,0.06)</blank>
                            <blank align="right" style="########0.000000000">IT.END_AV_MONTH(I,0.06)</blank>
                            <blank align="right" style="########0.000000000">IT.END_AV_B_PARTIAL_SURRENDER(I,0.06)</blank>
                            <blank align="right" style="########0.0000000000000">IT.MGT_FEE_AV_MONTH(I,0.06)</blank>
                            <blank align="right" style="########0.000000000">IT.AV_STAM_WITH_FLEXIBLE_PREMIUM(I,0.06)</blank>
                            <blank align="right" style="########0.000000000">IT.END_AV_A_PARTIAL_SURRENDER(I-1,0.06)</blank>
                        </row>
                    </loop>
                </table>



                <!--<table desc="報酬率1">-->
                    <!--<row type="title">-->
                        <!--<blank row="1">'保單年度'</blank>-->
                        <!--<blank row="1">'年齡'</blank>-->
                        <!--<blank row="1">'累積所繳保險費'</blank>-->
                        <!--<blank row="1">'相關費用（保費費用、保單管理費）'</blank>-->
                        <!--<blank row="1">'保險成本（附約保費、COI）'</blank>-->
                        <!--<blank row="1">'加值給付金'</blank>-->
                        <!--<blank row="1">'保單賬戶價值'</blank>-->
                    <!--</row>-->
                    <!--<loop from="0" to="m" step="1" name="I">-->
                        <!--<row>-->
                            <!--<blank style="##0">I+1</blank>-->
                            <!--<blank style="##0">AGE+I</blank>-->
                            <!--<blank align="right" style="########0">round(IT.PRM_T(I+1),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.MGT_FEE_YEAR(I,0.06),0)</blank>-->
                            <!--<blank align="right" style="########0">0</blank>-->
                            <!--<blank align="right" style="########0">round(IT.JZJFJ(I*12+1,0.06),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.END_AV_YEAR(I+1,0.06),0)</blank>-->
                        <!--</row>-->
                    <!--</loop>-->
                <!--</table>-->

                <!--<table desc="報酬率2">-->
                    <!--<row type="title">-->
                        <!--<blank row="1">'保單年度'</blank>-->
                        <!--<blank row="1">'年齡'</blank>-->
                        <!--<blank row="1">'累積所繳保險費'</blank>-->
                        <!--<blank row="1">'相關費用（保費費用、保單管理費）'</blank>-->
                        <!--<blank row="1">'保險成本（附約保費、COI）'</blank>-->
                        <!--<blank row="1">'加值給付金'</blank>-->
                        <!--<blank row="1">'保單賬戶價值'</blank>-->
                    <!--</row>-->
                    <!--<loop from="0" to="m" step="1" name="I">-->
                        <!--<row>-->
                            <!--<blank style="##0">I+1</blank>-->
                            <!--<blank style="##0">AGE+I</blank>-->
                            <!--<blank align="right" style="########0">round(IT.PRM_T(I+1),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.MGT_FEE_YEAR(I,0.02),0)</blank>-->
                            <!--<blank align="right" style="########0">0</blank>-->
                            <!--<blank align="right" style="########0">round(IT.JZJFJ(I*12+1,0.02),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.END_AV_YEAR(I+1,0.02),0)</blank>-->
                        <!--</row>-->
                    <!--</loop>-->
                <!--</table>-->

                <!--<table desc="報酬率3">-->
                    <!--<row type="title">-->
                        <!--<blank row="1">'保單年度'</blank>-->
                        <!--<blank row="1">'年齡'</blank>-->
                        <!--<blank row="1">'累積所繳保險費'</blank>-->
                        <!--<blank row="1">'相關費用（保費費用、保單管理費）'</blank>-->
                        <!--<blank row="1">'保險成本（附約保費、COI）'</blank>-->
                        <!--<blank row="1">'加值給付金'</blank>-->
                        <!--<blank row="1">'保單賬戶價值'</blank>-->
                    <!--</row>-->
                    <!--<loop from="0" to="m" step="1" name="I">-->
                        <!--<row>-->
                            <!--<blank style="##0">I+1</blank>-->
                            <!--<blank style="##0">AGE+I</blank>-->
                            <!--<blank align="right" style="########0">round(IT.PRM_T(I+1),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.MGT_FEE_YEAR(I,-0.06),0)</blank>-->
                            <!--<blank align="right" style="########0">0</blank>-->
                            <!--<blank align="right" style="########0">round(IT.JZJFJ(I*12+1,-0.06),0)</blank>-->
                            <!--<blank align="right" style="########0">round(IT.END_AV_YEAR(I+1,-0.06),0)</blank>-->
                        <!--</row>-->
                    <!--</loop>-->
                <!--</table>-->
            </benefit_table>

        </attachment>

        <rule skip="">
            <!--<if condition="AGE ge 61 and AGE le 70 and " type="customer">-->
                <!--投保年龄：被保险人出生满28天至65周岁。-->
            <!--</if>-->
        </rule>
    </product>
</declare>
